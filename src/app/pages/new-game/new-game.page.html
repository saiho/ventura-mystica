<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title translate>new-game</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large" translate>new-game</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-list>
    <ion-item>
      <ion-label translate>profile</ion-label>
      <ion-select [(ngModel)]="baseProfile" (ionChange)="onProfileChange()"
        [selectedText]="baseProfile.predefined ? (baseProfile.name | translate) : baseProfile.name">
        <ion-select-option *ngFor="let profile of allProfiles" [value]="profile">
          {{profile.predefined ? (profile.name | translate) : profile.name}}
        </ion-select-option>
      </ion-select>
    </ion-item>

    <form #form="ngForm">
      <ion-radio-group name="numPlayers" [(ngModel)]="numPlayers" (ionChange)="onNumPlayersChange()">
        <ion-item lines="none" class="item-label-stacked">
          <ion-label translate>number-of-players</ion-label>
          <ion-row>
            <ion-col *ngFor="let num of [2, 3, 4, 5]">
              <ion-item>
                <ion-label>{{num}}</ion-label>
                <ion-radio slot="start" [value]="num"></ion-radio>
              </ion-item>
            </ion-col>
          </ion-row>
        </ion-item>
      </ion-radio-group>

      <ion-item>
        <ion-label>
          <ion-text translate>factions</ion-text>
          <p>
            <ion-note class="ion-text-wrap" translate>factions-note</ion-note>
          </p>
        </ion-label>
        <ion-select #factionsSelect="ngModel" name="factions" [(ngModel)]="factions" (ionChange)="onFactionsChange()"
          [selectedText]="'factions-selected' | translate:({ num: factions.length })" multiple="true"
          appInputFactionsValidator [numPlayers]="numPlayers">
          <ion-select-option *ngFor="let faction of allFactions" [value]="faction" translate>{{faction.name}}
          </ion-select-option>
        </ion-select>
      </ion-item>
      <div class="ion-padding-horizontal ion-padding-bottom">
        <ion-text *ngIf="factionsSelect.errors?.invalidInputFactions" color="danger" translate>factions-invalid
        </ion-text>
      </div>

      <ion-item class="item-label-stacked">
        <ion-label>
          <ion-text translate>number-of-factions</ion-text>
          <p>
            <ion-note class="ion-text-wrap" translate [translateParams]="{ num: numFactions }">
              number-of-factions-note
            </ion-note>
          </p>
        </ion-label>
        <ion-range name="numFactions" [(ngModel)]="numFactions" pin="true" snaps="true" ticks="true" [min]="numPlayers"
          [max]="maxNumFactions <= numPlayers ? numPlayers + 1 : maxNumFactions"
          [disabled]="maxNumFactions <= numPlayers">
        </ion-range>
      </ion-item>

      <ion-item>
        <ion-label>
          <ion-text translate>bonus-cards</ion-text>
          <p>
            <ion-note class="ion-text-wrap" translate>bonus-cards-note</ion-note>
          </p>
        </ion-label>
        <ion-select #bonusCardsSelect="ngModel" name="bonusCards" [(ngModel)]="bonusCards"
          [selectedText]="'bonus-cards-selected' | translate:({ num: bonusCards.length })" multiple="true"
          appInputBonusCardsValidator [numPlayers]="numPlayers">
          <ion-select-option *ngFor="let bonusCard of allBonusCards" [value]="bonusCard" translate>
            {{bonusCard.description}}
          </ion-select-option>
        </ion-select>
      </ion-item>
      <div class="ion-padding-horizontal ion-padding-bottom">
        <ion-text *ngIf="bonusCardsSelect.errors?.invalidInputBonusCards" color="danger" translate>bonus-cards-invalid
        </ion-text>
      </div>

      <ion-item>
        <ion-label>
          <ion-text translate>scoring-tiles</ion-text>
          <p>
            <ion-note class="ion-text-wrap" translate>scoring-tiles-note</ion-note>
          </p>
        </ion-label>
        <ion-select #scoringTilesSelect="ngModel" name="scoringTiles" [(ngModel)]="scoringTiles"
          [selectedText]="'scoring-tiles-selected' | translate:({ num: scoringTiles.length })" multiple="true"
          appInputScoringTilesValidator>
          <ion-select-option *ngFor="let scoringTile of allScoringTiles" [value]="scoringTile">
            <div>
              <p>
                <ion-text><strong translate>action-phase-scoring</strong></ion-text>
                <ion-text translate>{{scoringTile.actionPhaseScoring}}</ion-text>
              </p>
              <p>
                <ion-text translate><strong>end-round-reward</strong></ion-text>
                <ion-text translate [translateParams]="{ count: scoringTile.endRoundRewardConditionCount}">
                  {{scoringTile.endRoundRewardCondition}}</ion-text>
                <ion-text translate [translateParams]="{ count: scoringTile.endRoundRewardCount}">
                  {{scoringTile.endRoundReward}}</ion-text>
              </p>
            </div>
          </ion-select-option>
        </ion-select>
      </ion-item>
      <div class="ion-padding-horizontal ion-padding-bottom">
        <ion-text *ngIf="scoringTilesSelect.errors?.invalidInputScoringTiles" color="danger" translate>
          scoring-tiles-invalid
        </ion-text>
      </div>

      <ion-item>
        <ion-label>
          <ion-text translate>extra-final-scoring-tiles</ion-text>
          <p>
            <ion-note class="ion-text-wrap" translate>extra-final-scoring-tiles-note</ion-note>
          </p>
        </ion-label>
        <ion-select name="extraFinalScoringTiles" [(ngModel)]="extraFinalScoringTiles"
          [selectedText]="'extra-final-scoring-tiles-selected' | translate:({ num: extraFinalScoringTiles.length })"
          multiple="true">
          <ion-select-option *ngFor="let extraFinalScoringTile of allExtraFinalScoringTiles"
            [value]="extraFinalScoringTile" translate>{{extraFinalScoringTile.name}}
          </ion-select-option>
        </ion-select>
      </ion-item>

      <ion-button (click)="onClickGenerate()" [disabled]="!form.valid" translate>generate</ion-button>
    </form>
  </ion-list>

  <ion-list *ngIf="generated">
    <ion-item-group>
      <ion-item-divider>
        <ion-label translate>factions</ion-label>
      </ion-item-divider>
      <ion-row>
        <ion-col *ngFor="let faction of pickedFactions">
          <ion-item>
            <ion-icon name="body-outline"></ion-icon>
            <ion-label translate>{{faction.name}}</ion-label>
          </ion-item>
        </ion-col>
      </ion-row>
    </ion-item-group>

    <ion-item-group>
      <ion-item-divider>
        <ion-label translate>bonus-cards</ion-label>
      </ion-item-divider>
      <ion-row>
        <ion-col *ngFor="let bonusCard of pickedBonusCards">
          <ion-item>
            <ion-icon name="ribbon-outline"></ion-icon>
            <ion-label translate>{{bonusCard.description}}</ion-label>
          </ion-item>
        </ion-col>
      </ion-row>
    </ion-item-group>

    <ion-item-group>
      <ion-item-divider>
        <ion-label translate>scoring-tiles</ion-label>
      </ion-item-divider>
    </ion-item-group>

    <ion-item-group>
      <ion-item-divider>
        <ion-label translate>final-scoring-tiles</ion-label>
      </ion-item-divider>
    </ion-item-group>
  </ion-list>

</ion-content>
